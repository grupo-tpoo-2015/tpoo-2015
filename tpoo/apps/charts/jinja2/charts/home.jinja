{% extends "base.jinja" %}

{% block css %}
<style>
        #vid-container {
      width:100%;
      height:100%;
      width: 820px;
      height: 461.25px;
      float: none;
      clear: both;
      margin: 2px auto;
   }

    svg {
     border-radius:3px;
    }
    .node {
        cursor: pointer;
    }

    .node circle {
      fill: #fff;
      stroke: #99ccff;;
      stroke-width: 3px;
    }

    .node text {
      font: 12px sans-serif;
    }

    .link {
      fill: none;
      stroke: #99ccff;
      stroke-width: 2px;
    }

.hyper {
    color: red;
    text-decoration: underline;
}

.hyper:hover {
    color:yellow;
    text-decoration: none;
}
.selected {
  font-weight:bold;
}
.not-selected {
  font-weight:normtal;
}



</style>

{% endblock %}

{% block content %}
    {% if datasets %}

        <svg id="tree"></svg>

        <h3>Gráficos de barras apiladas por test de usabilidad</h3>
        <p>
            Para cada tests de usabilidad se muestran los tiempos totales de cada tarea, comparados
            entre las distintas versiones.
        </p>
        {% for dataset in datasets %}
        <div class="col-md-6">
            <div class="panel panel-default chart-container">
                <div class="panel-heading">
                    <h3 class="panel-title">{{ dataset['title'] }}</h3>
                </div>
                <div class="panel-body">
                    <svg id="chart-{{ loop.index }}" class="chart"></svg>
                </div>
            </div>
        </div>
        {% endfor %}

        <h3>Gráficos de barras por participante</h3>
        <p>
            Para cada participante se muestran los tiempos que le llevó cada tarea.
        </p>
        <ul>
        {% for participant in participants %}
            <li>
                <a href="{{ url('bar_chart', args=[participant.id]) }}">{{ participant.name }}</a>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No hay datos para mostrar</p>
    {% endif %}
{% endblock %}

{% block js %}
<script type="text/javascript" src="{{ static('charts/js/stacked-bar-chart.js') }}"></script>
<script type="text/javascript" src="{{ static('charts/js/tree.js') }}"></script>
{% endblock %}

{% block js_init %}
<script>

    tree.init({
        data: {{ jsonify(tree_data) }},
        svgSelector: "#tree",
    });


    {% for dataset in datasets %}
    stackedBarChart.draw(d3.select("#chart-{{ loop.index }}"), {{ jsonify(dataset) }});
    {% endfor %}

</script>
{% endblock %}